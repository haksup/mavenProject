<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ajaxBoard">
	
	<select id="selectAjaxBoardCount" parameterType="hashmap" resultType="Integer">
		SELECT	/* ajaxBoard.selectAjaxBoardCount */
			COUNT(*) AS CNT
		FROM 
			BOARD
		WHERE
			BOARD_NAME = #{boardName}
	</select>
	
	<select id="selectAjaxBoard" parameterType="hashmap" resultType="hashmap">
		SELECT * FROM 
		(SELECT   ROWNUM RNUM
				, ROW_NUMBER() OVER (ORDER BY BOARD_NO ASC) AS BOARD_NUMBER
				, ORG.* FROM (
								SELECT /*+ INDEX_DESC(A PK_BOARD) */	/* ajaxBoard.selectAjaxBoard */
									  A.BOARD_NO
									, A.TITLE
									, A.CONTENTS
									, A.DEL_YN
									, TO_CHAR(A.REG_DATE, 'YYYY-MM-DD') AS REG_DATE
									, A.REG_USER
								FROM 
									BOARD A
								WHERE
									A.BOARD_NAME = #{boardName}
									AND A.DEL_YN = 'N'
		) ORG	) WHERE RNUM BETWEEN #{liststart} AND #{listend}
		ORDER BY BOARD_NUMBER DESC
	</select>
	
</mapper>
